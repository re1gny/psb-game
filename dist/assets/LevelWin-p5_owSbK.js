import{j as t,m as l,r as x,a as L,A as y,b}from"./index-bBi-YQRx.js";import{P as R}from"./Path-D_q9SC6c.js";import{C as w,A as j}from"./Rules-CEva1yYy.js";import{a8 as k}from"./overlay-iIL97Jt7.js";import{A as g}from"./levels-3nVI0IWL.js";import{u as S}from"./useStep-D2KHvblT.js";import{n as C}from"./new-overlay-BlR4uUT7.js";import{B as O}from"./Button-CjlHAt9L.js";import{q as A}from"./overlay-loose-BOz6UWXF.js";const u={0:{initialX:-40,initialY:162,initialRotate:-10,x:12,y:162,z:1,rotate:-5,origin:"top left"},1:{initialX:200,initialY:195.51,initialRotate:10,x:154.85,y:195.51,z:2,rotate:5,origin:"bottom left"}},E=c=>{const{className:a,cards:i,...p}=c;return t.jsxs(l.div,{className:`absolute top-0 left-0 w-full h-full z-30 ${a??""}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.4}},...p,children:[t.jsx(l.img,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute top-0 left-0 w-full h-full",src:k,alt:""}),t.jsxs("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-[calc(375px*var(--size-ratio))] max-h-[calc(667px*var(--size-ratio))]",children:[t.jsxs(l.svg,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,transition:{duration:.5,ease:"linear"}},transition:{duration:.3,ease:"easeInOut"},className:"w-[calc(273px*var(--size-ratio))] h-[calc(587px*var(--size-ratio)] absolute left-[calc(55.5px*var(--size-ratio))] top-[calc(22px*var(--size-ratio))]",viewBox:"0 0 273 587",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[t.jsx("path",{d:"M271.5 65L179.5 159L240.5 32L271.5 65Z",fill:"#EA5616"}),t.jsx("path",{d:"M197 78.5L159.5 166L173 70.5L197 78.5Z",fill:"#EA5616"}),t.jsx("path",{d:"M146.5 2L153.5 144.5L106.5 6.5L146.5 2Z",fill:"#EA5616"}),t.jsx("path",{d:"M5 539L87.5 457.5L36 584.5L5 539Z",fill:"#EA5616"}),t.jsx("path",{d:"M115 542.5L94.5 473L84 556.5L115 542.5Z",fill:"#EA5616"}),t.jsx("path",{d:"M1.5 469.5L71.5 453.5L1.5 495V469.5Z",fill:"#EA5616"}),t.jsx("path",{d:"M271.5 65L179.5 159L240.5 32L271.5 65Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"}),t.jsx("path",{d:"M197 78.5L159.5 166L173 70.5L197 78.5Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"}),t.jsx("path",{d:"M146.5 2L153.5 144.5L106.5 6.5L146.5 2Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"}),t.jsx("path",{d:"M5 539L87.5 457.5L36 584.5L5 539Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"}),t.jsx("path",{d:"M115 542.5L94.5 473L84 556.5L115 542.5Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"}),t.jsx("path",{d:"M1.5 469.5L71.5 453.5L1.5 495V469.5Z",stroke:"black",className:"stroke-[calc(2px*var(--size-ratio))]"})]}),i.map((o,e)=>t.jsx(l.div,{className:"absolute top-0 left-0",initial:{x:`calc(${u[e].initialX}px*var(--size-ratio))`,y:`calc(${u[e].initialY}px*var(--size-ratio))`,rotate:u[e].initialRotate},animate:{x:`calc(${u[e].x}px*var(--size-ratio))`,y:`calc(${u[e].y}px*var(--size-ratio))`,rotate:u[e].rotate},exit:{transition:{duration:.5,ease:"linear"}},transition:{duration:.3,ease:"easeInOut"},style:{transformOrigin:u[e].origin},children:t.jsx(w,{height:298.53,width:184.59,character:o})},e))]})]})},F={0:{initialX:57,initialY:122,initialRotate:0,x:57,y:122,z:1,rotate:0,exitX:-83,exitY:-98,exitRotate:-6}},I={0:{initialX:37.84,initialY:110,initialRotate:-5,x:47.84,y:100,z:1,rotate:-5,exitX:-63,exitY:-73,exitRotate:-6},1:{initialX:97.45,initialY:229.43,initialRotate:5,x:120.45,y:239.43,z:2,rotate:5,exitX:-59,exitY:-60,exitRotate:-6}},$=c=>{const{className:a,cards:i,onFinish:p,onNext:o,collectionRef:e,...d}=c,[h,v]=x.useState(!1),[m,z]=x.useState(0),n=x.useRef(null);x.useLayoutEffect(()=>{const f=L.getState().contentRef;if(n.current&&(f!=null&&f.current)){const s=L.getState().sizeRatio;z((n.current.getBoundingClientRect().left-f.current.getBoundingClientRect().left)/s)}},[n.current]);const N=()=>{o==null||o(),v(!0)},r=i.length===2?I:F;return t.jsx(l.div,{className:`absolute top-0 left-0 w-full h-full z-30 ${a??""}`,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0,transition:{duration:.4}},...d,children:t.jsx(y,{onExitComplete:()=>p==null?void 0:p(),children:!h&&t.jsxs(t.Fragment,{children:[t.jsx(l.img,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute top-0 left-0 w-full h-full",src:A,alt:""}),t.jsx(l.div,{initial:{opacity:0,scale:.6,rotate:-25},animate:{opacity:1,scale:1,rotate:0},exit:{opacity:0,transition:{duration:.2,ease:"easeInOut"}},transition:{duration:.4,ease:"easeInOut"},className:"absolute top-0 left-0 w-full h-full",children:t.jsx("img",{className:"absolute top-[calc(-141px*var(--size-ratio))] left-1/2 -translate-x-1/2 w-[calc(730px*var(--size-ratio))] h-[calc(948px*var(--size-ratio))]",src:C,alt:""})}),t.jsxs("div",{ref:n,className:"absolute top-0 left-1/2 -translate-x-1/2 w-full h-full max-w-[calc(375px*var(--size-ratio))] max-h-[calc(667px*var(--size-ratio))]",children:[t.jsx(l.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0},className:"flex flex-col items-center absolute top-[calc(26px*var(--size-ratio))] left-[calc(20px*var(--size-ratio))] w-[calc(100%-(40px*var(--size-ratio)))]",children:t.jsx(l.div,{className:"relative flex items-center justify-center bg-[#FFFFFF] border-2 border-[#000000] rounded-[calc(7.41px*var(--size-ratio))] w-full h-[calc(62px*var(--size-ratio))] z-10",children:t.jsx("p",{className:"whitespace-pre-line font-inter font-semibold text-[calc(20px*var(--size-ratio))] leading-[105%] tracking-[0.01em] text-[#00029D]",children:i.length===2?"Ты получил новые карты!":"Ты получил новую карту!"})})}),i.map((f,s)=>t.jsx(l.div,{className:"absolute top-0 left-0 rounded-[calc(8.79px*var(--size-ratio))]",initial:{opacity:0,x:`calc(${r[s].initialX}px*var(--size-ratio))`,y:`calc(${r[s].initialY}px*var(--size-ratio))`,rotate:r[s].initialRotate,scale:0,boxShadow:"none"},animate:{opacity:1,x:`calc(${r[s].x}px*var(--size-ratio))`,y:`calc(${r[s].y}px*var(--size-ratio))`,rotate:r[s].rotate,scale:1,boxShadow:"calc(0px*var(--size-ratio)) calc(0px*var(--size-ratio)) calc(22px*var(--size-ratio)) calc(0px*var(--size-ratio)) #FFFFFF"},exit:{opacity:0,x:`calc(${r[s].exitX-m}px*var(--size-ratio))`,y:`calc(${r[s].exitY}px*var(--size-ratio))`,rotate:r[s].exitRotate,scale:.05,boxShadow:"none",transition:{duration:.8,ease:"easeInOut",opacity:{delay:.5,duration:.3},rotate:{delay:.3,duration:.5}}},children:t.jsx(w,{height:i.length===2?337.66:422,width:i.length===2?208.78:260.93,character:f})},s))]}),t.jsx(l.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0},className:"flex flex-col items-center absolute bottom-[calc(30px*var(--size-ratio))] left-[calc(20px*var(--size-ratio))] w-[calc(100%-(40px*var(--size-ratio)))]",children:t.jsx(O,{className:"absolute",onClick:N,children:"Забрать"})})]})})})};function V({level:c}){const[a,i]=S(`level-${c.id}-win`,0),p=b(),[o,e]=x.useState(!1),d=x.useRef(null),h=j.filter(n=>c.correctCharacters.includes(n.id)),v=j.filter(n=>c.winNewCharacters.includes(n.id)),m=c.id===g[g.length-1].id,z=()=>{i(),e(!0)};return x.useEffect(()=>{a===0&&setTimeout(()=>i(),300),a===1&&setTimeout(()=>i(),1600),!m&&a===2&&setTimeout(()=>i(),300),m&&a===2&&setTimeout(()=>p({to:"/final"}),800)},[a]),x.useEffect(()=>{o&&setTimeout(()=>e(!1),200)},[o]),t.jsxs(t.Fragment,{children:[t.jsx(R,{withRules:!1,blur:a===1||a===3,pulse:o,collectionRef:d}),t.jsx(y,{children:a===1&&t.jsx(E,{cards:h})}),t.jsx(y,{children:(a===3||a===4)&&!m&&t.jsx($,{cards:v,onFinish:z,onNext:i,collectionRef:d})})]})}export{V as L};
